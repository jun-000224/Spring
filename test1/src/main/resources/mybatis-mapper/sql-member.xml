<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.MemberMapper">

	<select id="memberCheck" parameterType="hashmap" resultType="com.example.test1.model.Member">
		SELECT *
		FROM TBL_USER
		WHERE USERID = #{id}   
	</select>
	
	<insert id="memberAdd" parameterType="hashmap">
		INSERT INTO TBL_USER (
			USERID, PASSWORD, NAME, ADDRESS, PHONE, EMAIL, GENDER, STATUS, CDATETIME, UDATETIME, CNT
		)
		VALUES(
			#{id}, #{pwd}, #{name}, #{address}, #{phone}, #{email}, #{gender}, #{status}, SYSDATE, SYSDATE, 0
		)
	</insert>
	
	<select id="selectMemberList" parameterType="hashmap" resultType="com.example.test1.model.Member">
		SELECT 
			U.*,
			DECODE(
		        BIRTH,
		        NULL,
		        '정보없음',
		        SUBSTR(BIRTH, 3, 2) || '.' || SUBSTR(BIRTH, 5, 2) || '.' || SUBSTR(BIRTH, 7, 2)
		    ) CBIRTH
		FROM TBL_USER U
	</select>
	
	<update id="cntIncrease" parameterType="hashmap">
	UPDATE TBL_USER
		SET 
			CNT = CNT + 1
		WHERE USERID = #{id}  </update>
	
	<update id="cntInit" parameterType="hashmap">
		UPDATE TBL_USER
		SET 
			CNT = 0
		WHERE USERID = #{id}  
	</update>
	
	
	<select id = "authMember" parameterType="hashmap" resultType="com.example.test1.model.Member"> 
	SELECT * FROM TBL_USER
	WHERE USERID = TRIM(#{userId})
      AND NAME = TRIM(#{name})
      AND REPLACE(PHONE, '-', '') = REPLACE(#{phone}, '-', '')
	</select>
	
	
	
	<update id="updatePassword" parameterType="hashmap">
	UPDATE TBL_USER
	SET
		PASSWORD = #{pwd}
	WHERE
		USERID = #{userId}
	
	</update>
	
</mapper>